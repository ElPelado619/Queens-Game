(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const l of n)if(l.type==="childList")for(const i of l.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function o(n){const l={};return n.integrity&&(l.integrity=n.integrity),n.referrerPolicy&&(l.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?l.credentials="include":n.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(n){if(n.ep)return;n.ep=!0;const l=o(n);fetch(n.href,l)}})();const ae="0.4.1";function ie(){const e=new Date().toLocaleString(),t=["color: #61dafb","background-color: #222","padding: 4px 8px","border-radius: 4px","font-family: monospace"].join(";");console.log(`%c♕ Queens Game v${ae} | ${e} ♕`,t)}typeof window<"u"&&(ie(),performance?.mark&&performance.mark("game_init_start"));const ce="modulepreload",de=function(e){return"https://elpelado619.github.io/Queens-Game/"+e},G={},v=function(t,o,r){let n=Promise.resolve();if(o&&o.length>0){let p=function(_){return Promise.all(_.map(S=>Promise.resolve(S).then($=>({status:"fulfilled",value:$}),$=>({status:"rejected",reason:$}))))};var i=p;document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),c=a?.nonce||a?.getAttribute("nonce");n=p(o.map(_=>{if(_=de(_),_ in G)return;G[_]=!0;const S=_.endsWith(".css"),$=S?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${_}"]${$}`))return;const E=document.createElement("link");if(E.rel=S?"stylesheet":ce,S||(E.as="script"),E.crossOrigin="",E.href=_,c&&E.setAttribute("nonce",c),document.head.appendChild(E),S)return new Promise((le,se)=>{E.addEventListener("load",le),E.addEventListener("error",()=>se(new Error(`Unable to preload CSS for ${_}`)))})}))}function l(a){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=a,window.dispatchEvent(c),!c.defaultPrevented)throw a}return n.then(a=>{for(const c of a||[])c.status==="rejected"&&l(c.reason);return t().catch(l)})},ue=Object.assign({"./boards6.js":()=>v(()=>import("./boards6-C5N9PQ90.js"),[]),"./boards7.js":()=>v(()=>import("./boards7-_AeYOdc4.js"),[]),"./boards8.js":()=>v(()=>import("./boards8-eyEYXSly.js"),[]),"./boards9.js":()=>v(()=>import("./boards9-CilZ8B53.js"),[]),"./chaosBoards10.js":()=>v(()=>import("./chaosBoards10-DuAJgUPw.js"),[]),"./chaosBoards6.js":()=>v(()=>import("./chaosBoards6-HEwkA7iM.js"),[]),"./chaosBoards7.js":()=>v(()=>import("./chaosBoards7-BlOR_rZY.js"),[]),"./chaosBoards8.js":()=>v(()=>import("./chaosBoards8-QrK0K2FD.js"),[]),"./chaosBoards9.js":()=>v(()=>import("./chaosBoards9-D_NqF0HB.js"),[])});async function U(e,t,o){let r=`./boards${e}.js`;t==="chaos"&&(r=`./chaosBoards${e}.js`);const n=ue[r];if(!n)return console.error(`No board file found for path: ${r}`),null;const i=(await n())[`boards${e}`];if(!i)return console.error(`No boards object named boards${e} in ${r}`),null;if(!isNaN(o)&&o>=1){const p=`board_${o}`;if(!(p in i))console.warn(`${p} does not exist in boards${e}. Returning a random board instead.`),alert(`${p} does not exist in boards${e}. Returning a random board instead.`);else return console.log(`Loaded ${p}, from boards${e} in ${r}`),{matrix_key:i[p],board_number:o}}const a=Object.keys(i);if(a.length===0)return console.error(`No boards found in boards${e}`),null;const c=a[Math.floor(Math.random()*a.length)];return{matrix_key:i[c],board_number:parseInt(c.split("_")[1])}}let y=0,j=null;const Y=document.getElementById("timer");function me(e){clearInterval(j);const t=localStorage.getItem("gameCompleted")==="true",o=JSON.parse(localStorage.getItem("miliseconds"));o!==null&&typeof o=="number"&&(y=o),z(),!t&&(e&&(y=0,localStorage.setItem("miliseconds",JSON.stringify(y)),z()),j=setInterval(fe,10))}function fe(){y+=10,localStorage.setItem("miliseconds",JSON.stringify(y));const e=Math.floor(y/1e3),t=Math.floor(e/3600),o=Math.floor(e%3600/60),r=e%60,n=Math.floor(y%1e3/10),l=`${String(t).padStart(2,"0")}:${String(o).padStart(2,"0")}:${String(r).padStart(2,"0")}.${String(n).padStart(2,"0")}`;Y.textContent=l}function z(){const e=Math.floor(y/1e3),t=Math.floor(e/3600),o=Math.floor(e%3600/60),r=e%60,n=Math.floor(y%1e3/10),l=`${String(t).padStart(2,"0")}:${String(o).padStart(2,"0")}:${String(r).padStart(2,"0")}.${String(n).padStart(2,"0")}`;Y.textContent=l}function Z(){clearInterval(j),j=null}function _e(){return y}const b={},F={place:.4,remove:.38,win:0},W={place:1.2,remove:.45,win:1},X={place:1,remove:1.85,win:1},O={place:.25,remove:.25,win:.3};let P=!1;const V="https://elpelado619.github.io/Queens-Game/audio/";function ge(){b.place=new Audio(V+"place.mp3"),b.remove=new Audio(V+"place.mp3"),b.win=new Audio(V+"win.mp3"),b.place.volume=O.place,b.remove.volume=O.remove,b.win.volume=O.win}function H(e){if(!P){if(!b[e]){console.warn(`Sound "${e}" not loaded`);return}try{const t=new Audio(b[e].src);t.currentTime=F[e],t.playbackRate=W[e]*X[e],t.volume=O[e],t.play().catch(o=>{console.warn("Audio play failed:",o);try{const r=new Audio(`/audio/${e==="remove"?"place":e}.mp3`);r.currentTime=F[e],r.playbackRate=W[e]*X[e],r.volume=O[e],r.play()}catch(r){console.warn("Fallback failed:",r)}})}catch(t){console.warn("Sound playback error:",t)}}}function ye(){const e=()=>{const t=new Audio;t.volume=0,t.play().then(()=>t.remove()),document.removeEventListener("click",e),document.removeEventListener("touchstart",e)};document.addEventListener("click",e,{once:!0}),document.addEventListener("touchstart",e,{once:!0})}ge();ye();document.getElementById("volume").addEventListener("click",()=>{const e=document.getElementById("volume");P?(e.classList.remove("volume_off"),e.classList.add("volume_on"),P=!1):(e.classList.remove("volume_on"),e.classList.add("volume_off"),P=!0)});let s=[],I=[],d=null,m=!1,M=!1,h=null,w=new Set,A=null,L=!0,K=!1,x=null,T="cross";document.getElementById("switch_marker").addEventListener("click",ee);document.addEventListener("keydown",function(e){e.key===" "&&ee()});function ee(){const e=document.getElementById("switch_marker");T==="cross"?(T="flag",e.innerHTML='<img src="src/assets/images/flag.svg" class="switch_marker_image flag" alt="Change marker button"></img>'):(T="cross",e.innerHTML='<img src="src/assets/images/cross.svg" class="switch_marker_image cross" alt="Change marker button"></img>')}window.addEventListener("blur",()=>{M=!1,h=null,w.clear()});document.addEventListener("mousedown",e=>{if(m||e.button!==0&&e.button!==2)return;M=!0,h=e.button,w.clear(),L=!0;const t=e.target.closest("td");if(t&&t.id){const o=t.id.split("_");if(o.length>=3){const r=Number(o[1]),n=Number(o[2]);if(h===2){K=!0;const l=s[r]?s[r][n]:void 0;x=l===3?"erase_flags":l===2?"erase_crosses":"draw"}k(r,n,h===0?1:2)}}});document.addEventListener("contextmenu",e=>{K&&e.preventDefault(),K=!1});document.addEventListener("mouseup",e=>{e.button===h&&(M=!1,h=null,x=null,A=setTimeout(()=>w.clear(),50))});document.getElementById("board").addEventListener("contextmenu",e=>e.preventDefault());document.getElementById("board_table").addEventListener("contextmenu",e=>e.preventDefault());function te(){M=!1,h=null,w.clear(),L=!0,A&&(clearTimeout(A),A=null)}async function ne(e,t){if(!e)return;document.getElementById("timer").style.color="var(--color_text)",document.getElementById("timer").style.textShadow="0 0 0px #00000000",I=e,d=I.length;let o=!0;const r=localStorage.getItem("queens_matrix");if(m=localStorage.getItem("gameCompleted")==="true",r&&!t)try{const l=JSON.parse(r);if(Array.isArray(l)&&l.length===d)s=l,o=!1;else throw new Error("Invalid size")}catch{q("all"),localStorage.setItem("queens_matrix",JSON.stringify(s))}else q("all"),localStorage.setItem("queens_matrix",JSON.stringify(s));J(),ve(),m?Z():me(o&&!m),N()}function J(){Q=[];for(let e=0;e<d;e++)for(let t=0;t<d;t++)D(e,t)}function D(e,t){const o=document.getElementById(`cell_${e}_${t}`);if(!o)return;const r=s[e][t];if(o.innerHTML="",r===1){const n=document.createElement("div");n.className="board_icons icon_queen",n.dataset.row=e,n.dataset.col=t,o.appendChild(n)}else if(r===2){const n=document.createElement("div");n.className="board_icons icon_cross",o.appendChild(n)}else if(r===3){const n=document.createElement("div");n.className="board_icons icon_flag",o.appendChild(n)}}function k(e,t,o){if(m||!pe(e,t))return;const r=`${e}_${t}`;if(!w.has(r)){if(w.add(r),s[e][t],o===1){const n=s[e][t]===1;s[e][t]=n?0:1,L&&(s[e][t]===1?H("place"):n&&H("remove"))}else if(o===2){const n=T==="flag"?3:2;s[e][t]=s[e][t]===n?0:n}L=!1,D(e,t),localStorage.setItem("queens_matrix",JSON.stringify(s)),N()}}function ve(){for(let e=0;e<d;e++)for(let t=0;t<d;t++){const o=document.getElementById(`cell_${e}_${t}`);if(!o)continue;const r=o.cloneNode(!0);o.replaceWith(r),r.addEventListener("mouseenter",()=>{if(M&&!m)if(h===2)if(x==="draw"){const n=T==="flag"?3:2;s[e][t]!==n&&k(e,t,2)}else(x==="erase_flags"&&s[e][t]===3||x==="erase_crosses"&&s[e][t]===2)&&(s[e][t]=0,D(e,t),localStorage.setItem("queens_matrix",JSON.stringify(s)));else k(e,t,1)}),r.addEventListener("click",n=>{n.button===0&&!m&&(L=!0,k(e,t,1))}),r.addEventListener("contextmenu",n=>{n.preventDefault(),m||(L=!0,k(e,t,2))})}}function q(e){if(te(),e==="crosses"){for(let t=0;t<d;t++)for(let o=0;o<d;o++)if(s[t][o]===2){s[t][o]=0;const r=document.getElementById(`cell_${t}_${o}`);r&&(r.innerHTML="")}}else if(e==="flags"){for(let t=0;t<d;t++)for(let o=0;o<d;o++)if(s[t][o]===3){s[t][o]=0;const r=document.getElementById(`cell_${t}_${o}`);r&&(r.innerHTML="")}}else{m=!1,localStorage.setItem("gameCompleted","false"),s=[];for(let t=0;t<d;t++){s[t]=[];for(let o=0;o<d;o++){s[t][o]=0;const r=document.getElementById(`cell_${t}_${o}`);r&&(r.innerHTML="")}}}}function pe(e,t){return e>=0&&e<d&&t>=0&&t<d}document.getElementById("clear_board").addEventListener("click",()=>{m||(q("all"),localStorage.setItem("queens_matrix",JSON.stringify(s)),J(),N())});document.getElementById("clear_crosses").addEventListener("click",()=>{m||(q("crosses"),localStorage.setItem("queens_matrix",JSON.stringify(s)),J(),N())});document.getElementById("clear_flags").addEventListener("click",()=>{m||(q("flags"),localStorage.setItem("queens_matrix",JSON.stringify(s)),J(),N())});let Q=[];function N(){if(m||!I)return!1;Q=[];let e=!0;const t=[],o={},r=I&&I.flat?new Set(I.flat()):new Set;for(let n=0;n<d;n++)for(let l=0;l<d;l++){const i=document.getElementById(`cell_${n}_${l}`);if(i){const a=i.querySelector(".icon_queen");a&&a.classList.remove("invalid_queen")}if(s[n][l]===1){const a=I[n][l];t.push({row:n,col:l,color:a}),o[a]=(o[a]||0)+1}}for(let n=0;n<t.length;n++){let l=!1;for(let i=0;i<t.length;i++){if(n===i)continue;const a=t[n],c=t[i];(a.row===c.row||a.col===c.col||a.color===c.color||Math.abs(a.row-c.row)===1&&Math.abs(a.col-c.col)===1)&&(l=!0)}if(l){Q.push([t[n].row,t[n].col]);const i=document.querySelector(`#cell_${t[n].row}_${t[n].col} .icon_queen`);i&&i.classList.add("invalid_queen"),e=!1}}for(const n of r)if(o[n]!==1){e=!1;break}return e&&t.length>0&&(m=!0,localStorage.setItem("gameCompleted","true"),localStorage.setItem("miliseconds",JSON.stringify(_e())),te(),Z(),H("win"),Ee(),document.getElementById("timer").style.color="var(--timer_victory_color)",document.getElementById("timer").style.textShadow="0 0 10px #61e82c"),e}function Ee(){for(let e=0;e<d;e++){const t=e*.3;for(let o=0;o<d;o++){const r=document.getElementById(`cell_${e}_${o}`);r&&(r.classList.add("victory_row"),r.style.animationDelay=`${t}s`)}}}let g=null,C=null;document.addEventListener("DOMContentLoaded",async()=>{const e=localStorage.getItem("colors_matrix");if(C=localStorage.getItem("current_board_number"),document.getElementById("board_number").value=parseInt(C),oe(),e){g=JSON.parse(e);const t=g.length;re(t,g),ne(g,!1)}else C?await R("by_number"):await R("random")});document.getElementById("new_game").addEventListener("click",()=>R("random"));document.getElementById("load_by_number").addEventListener("click",()=>R("by_number"));document.getElementById("board_number").addEventListener("change",()=>{oe()});window.addEventListener("beforeunload",()=>{localStorage.setItem("current_board_number",C)});function oe(){const e=parseInt(document.getElementById("board_number").value),t=document.getElementById("load_by_number");!e||e<1?(t.disabled=!0,t.classList.add("disabled")):(t.disabled=!1,t.classList.remove("disabled"))}async function R(e){const t=parseInt(document.getElementById("size").value),o=document.getElementById("difficulty").value;let r;if(e==="by_number"){const n=parseInt(document.getElementById("board_number").value);r=await U(t,o,n),g=r.matrix_key}else r=await U(t,o,null),g=r.matrix_key;g?(re(t,g),ne(g,!0),localStorage.setItem("colors_matrix",JSON.stringify(g)),document.getElementById("board_number").value=parseInt(r.board_number),C=r.board_number):alert("Couldn't get a new board with the selected settings."),localStorage.setItem("current_board_number",r.board_number)}function re(e,t){const o=document.getElementById("board");o.innerHTML="";for(let r=0;r<e;r++){const n=document.createElement("tr");for(let l=0;l<e;l++){const i=document.createElement("td"),a=t[r][l];i.id=`cell_${r}_${l}`,i.className=`cell_color_${a}`,n.appendChild(i)}o.appendChild(n)}}let f={grid:null,visual_help:null,theme:null,difficulty:null,size:null};const u=document;function be(){const e=localStorage.getItem("stored_selections");if(e)try{f=JSON.parse(e),u.getElementById("grid_selector").value=f.grid,u.getElementById("visual_settings").value=f.visual_help,u.getElementById("theme_selector").value=f.theme,u.getElementById("difficulty").value=f.difficulty,u.getElementById("size").value=f.size}catch(t){console.warn("Error parsing stored selections",t)}}function B(){f.grid=u.getElementById("grid_selector").value,f.visual_help=u.getElementById("visual_settings").value,f.theme=u.getElementById("theme_selector").value,f.difficulty=u.getElementById("difficulty").value,f.size=u.getElementById("size").value,localStorage.setItem("stored_selections",JSON.stringify(f))}window.addEventListener("DOMContentLoaded",be);window.addEventListener("beforeunload",B);u.getElementById("grid_selector").addEventListener("change",B);u.getElementById("visual_settings").addEventListener("change",B);u.getElementById("theme_selector").addEventListener("change",B);u.getElementById("difficulty").addEventListener("change",B);u.getElementById("size").addEventListener("change",B);
