(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const l of n)if(l.type==="childList")for(const i of l.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function o(n){const l={};return n.integrity&&(l.integrity=n.integrity),n.referrerPolicy&&(l.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?l.credentials="include":n.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(n){if(n.ep)return;n.ep=!0;const l=o(n);fetch(n.href,l)}})();const ne="0.3.0";function oe(){const e=new Date().toLocaleString(),t=["color: #61dafb","background-color: #222","padding: 4px 8px","border-radius: 4px","font-family: monospace"].join(";");console.log(`%c♕ Queens Game v${ne} | ${e} ♕`,t)}typeof window<"u"&&(oe(),performance?.mark&&performance.mark("game_init_start"));const re="modulepreload",le=function(e){return"https://elpelado619.github.io/Queens-Game/"+e},D={},$=function(t,o,r){let n=Promise.resolve();if(o&&o.length>0){let N=function(g){return Promise.all(g.map(E=>Promise.resolve(E).then(B=>({status:"fulfilled",value:B}),B=>({status:"rejected",reason:B}))))};var i=N;document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),a=s?.nonce||s?.getAttribute("nonce");n=N(o.map(g=>{if(g=le(g),g in D)return;D[g]=!0;const E=g.endsWith(".css"),B=E?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${g}"]${B}`))return;const y=document.createElement("link");if(y.rel=E?"stylesheet":re,E||(y.as="script"),y.crossOrigin="",y.href=g,a&&y.setAttribute("nonce",a),document.head.appendChild(y),E)return new Promise((ee,te)=>{y.addEventListener("load",ee),y.addEventListener("error",()=>te(new Error(`Unable to preload CSS for ${g}`)))})}))}function l(s){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=s,window.dispatchEvent(a),!a.defaultPrevented)throw s}return n.then(s=>{for(const a of s||[])a.status==="rejected"&&l(a.reason);return t().catch(l)})},se=Object.assign({"./chaosBoards10.js":()=>$(()=>import("./chaosBoards10-DuAJgUPw.js"),[]),"./chaosBoards6.js":()=>$(()=>import("./chaosBoards6-Cx5GKkuQ.js"),[]),"./chaosBoards7.js":()=>$(()=>import("./chaosBoards7-BlOR_rZY.js"),[]),"./chaosBoards8.js":()=>$(()=>import("./chaosBoards8-wKjnYf-Q.js"),[]),"./chaosBoards9.js":()=>$(()=>import("./chaosBoards9-D_NqF0HB.js"),[])});async function ie(e,t){let o=`./boards${e}.js`;t==="chaos"&&(o=`./chaosBoards${e}.js`);const r=se[o];if(!r)return console.error(`No board file found for path: ${o}`),null;const l=(await r())[`boards${e}`];if(!l)return console.error(`No boards object named boards${e} in ${o}`),null;const i=Object.values(l);if(i.length===0)return console.error(`No boards found in boards${e}`),null;const s=Math.floor(Math.random()*i.length);return i[s]}let _=0,q=null;const G=document.getElementById("timer");function ce(e){clearInterval(q);const t=localStorage.getItem("gameCompleted")==="true",o=JSON.parse(localStorage.getItem("miliseconds"));o!==null&&typeof o=="number"&&(_=o),J(),!t&&(e&&(_=0,localStorage.setItem("miliseconds",JSON.stringify(_)),J()),q=setInterval(ae,10))}function ae(){_+=10,localStorage.setItem("miliseconds",JSON.stringify(_));const e=Math.floor(_/1e3),t=Math.floor(e/3600),o=Math.floor(e%3600/60),r=e%60,n=Math.floor(_%1e3/10),l=`${String(t).padStart(2,"0")}:${String(o).padStart(2,"0")}:${String(r).padStart(2,"0")}.${String(n).padStart(2,"0")}`;G.textContent=l}function J(){const e=Math.floor(_/1e3),t=Math.floor(e/3600),o=Math.floor(e%3600/60),r=e%60,n=Math.floor(_%1e3/10),l=`${String(t).padStart(2,"0")}:${String(o).padStart(2,"0")}:${String(r).padStart(2,"0")}.${String(n).padStart(2,"0")}`;G.textContent=l}function H(){clearInterval(q),q=null}function de(){return _}const h={},R={place:.4,remove:.38,win:0},V={place:1.2,remove:.45,win:1},z={place:1,remove:1.85,win:1},O={place:.25,remove:.25,win:.3};let C=!1;const A="https://elpelado619.github.io/Queens-Game/audio/";function ue(){h.place=new Audio(A+"place.mp3"),h.remove=new Audio(A+"place.mp3"),h.win=new Audio(A+"win.mp3"),h.place.volume=O.place,h.remove.volume=O.remove,h.win.volume=O.win}function P(e){if(!C){if(!h[e]){console.warn(`Sound "${e}" not loaded`);return}try{const t=new Audio(h[e].src);t.currentTime=R[e],t.playbackRate=V[e]*z[e],t.volume=O[e],t.play().catch(o=>{console.warn("Audio play failed:",o);try{const r=new Audio(`/audio/${e==="remove"?"place":e}.mp3`);r.currentTime=R[e],r.playbackRate=V[e]*z[e],r.volume=O[e],r.play()}catch(r){console.warn("Fallback failed:",r)}})}catch(t){console.warn("Sound playback error:",t)}}}function me(){const e=()=>{const t=new Audio;t.volume=0,t.play().then(()=>t.remove()),document.removeEventListener("click",e),document.removeEventListener("touchstart",e)};document.addEventListener("click",e,{once:!0}),document.addEventListener("touchstart",e,{once:!0})}ue();me();document.getElementById("volume").addEventListener("click",()=>{const e=document.getElementById("volume");C?(e.classList.remove("volume_off"),e.classList.add("volume_on"),C=!1):(e.classList.remove("volume_on"),e.classList.add("volume_off"),C=!0)});let c=null,M=null,u=null,f=!1,x=!1,v=null,w=new Set,T=null,b=!0,k=!1,S=null;window.addEventListener("blur",()=>{x=!1,v=null,w.clear()});document.addEventListener("mousedown",e=>{if(!f&&!(e.button!==0&&e.button!==2))if(x=!0,v=e.button,w.clear(),b=!0,e.target.closest("td")){const t=e.target.closest("td"),[o,r,n]=t.id.split("_").map(Number);v===2&&(k=!0,S="draw",c[r]&&c[r][n]===2?S="erase":S="draw"),I(r,n,v===0?1:2)}else v===2&&(k=!1)});document.addEventListener("contextmenu",e=>{k&&e.preventDefault(),k=!1});document.addEventListener("mouseup",e=>{e.button===v&&(x=!1,v=null,S=null,T=setTimeout(()=>w.clear(),50))});document.getElementById("board").addEventListener("contextmenu",e=>e.preventDefault());document.getElementById("board_table").addEventListener("contextmenu",e=>e.preventDefault());function U(){x=!1,v=null,w.clear(),b=!0,T&&(clearTimeout(T),T=null)}async function F(e,t){document.getElementById("timer").style.color="var(--color_text)",document.getElementById("timer").style.textShadow="0 0 0px #00000000",M=e,u=M.length;let o=!0;const r=localStorage.getItem("queens_matrix");if(f=localStorage.getItem("gameCompleted")==="true",r&&!t)try{const l=JSON.parse(r);if(Array.isArray(l)&&l.length===u)c=l,o=!1;else throw new Error("Invalid size")}catch{j(),localStorage.setItem("queens_matrix",JSON.stringify(c))}else j(),localStorage.setItem("queens_matrix",JSON.stringify(c));W(),fe(),f?H():ce(o&&!f),X()}function W(){for(let e=0;e<u;e++)for(let t=0;t<u;t++)K(e,t)}function K(e,t){const o=document.getElementById(`cell_${e}_${t}`);if(!o)return;const r=c[e][t];if(o.innerHTML="",r===1){const n=document.createElement("div");n.className="board_icons icon_queen",n.dataset.row=e,n.dataset.col=t,o.appendChild(n)}else if(r===2){const n=document.createElement("div");n.className="board_icons icon_cross",o.appendChild(n)}}function I(e,t,o){if(f||!ge(e,t))return;const r=`${e}_${t}`;if(!w.has(r)){if(w.add(r),c[e][t],o===1){const n=c[e][t]===1;c[e][t]=n?0:1,b&&(c[e][t]===1?P("place"):n&&P("remove"))}else o===2&&(c[e][t]=c[e][t]===2?0:2);b=!1,K(e,t),localStorage.setItem("queens_matrix",JSON.stringify(c)),X()}}function fe(){for(let e=0;e<u;e++)for(let t=0;t<u;t++){const o=document.getElementById(`cell_${e}_${t}`);if(!o)continue;const r=o.cloneNode(!0);o.replaceWith(r),r.addEventListener("mouseenter",()=>{if(x&&!f)if(v===2){const n=c[e][t];(S==="draw"&&n!==2||S==="erase"&&n===2)&&I(e,t,2)}else I(e,t,1)}),r.addEventListener("click",n=>{n.button===0&&!f&&(b=!0,I(e,t,1))}),r.addEventListener("contextmenu",n=>{n.preventDefault(),f||(b=!0,I(e,t,2))})}}function j(){f=!1,localStorage.setItem("gameCompleted","false"),U(),c=[];for(let e=0;e<u;e++){c[e]=[];for(let t=0;t<u;t++){c[e][t]=0;const o=document.getElementById(`cell_${e}_${t}`);o&&(o.innerHTML="")}}}function ge(e,t){return e>=0&&e<u&&t>=0&&t<u}document.getElementById("clear_board").addEventListener("click",()=>{f||(j(),localStorage.setItem("queens_matrix",JSON.stringify(c)),W())});let Q=[];function X(){if(f)return!0;Q=[];let e=!0;const t=[],o={};for(let n=0;n<u;n++)for(let l=0;l<u;l++){const i=document.getElementById(`cell_${n}_${l}`);if(i){const s=i.querySelector(".icon_queen");s&&s.classList.remove("invalid_queen")}if(c[n][l]===1){const s=M[n][l];t.push({row:n,col:l,color:s}),o[s]=(o[s]||0)+1}}for(let n=0;n<t.length;n++){let l=!1;for(let i=0;i<t.length;i++){if(n===i)continue;const s=t[n],a=t[i];(s.row===a.row||s.col===a.col||s.color===a.color||Math.abs(s.row-a.row)===1&&Math.abs(s.col-a.col)===1)&&(l=!0)}if(l){Q.push([t[n].row,t[n].col]);const i=document.querySelector(`#cell_${t[n].row}_${t[n].col} .icon_queen`);i&&i.classList.add("invalid_queen"),e=!1}}const r=new Set(M.flat());for(const n of r)if(o[n]!==1){e=!1;break}return e&&t.length>0&&(f=!0,localStorage.setItem("gameCompleted","true"),localStorage.setItem("miliseconds",JSON.stringify(de())),U(),H(),P("win"),_e(),document.getElementById("timer").style.color="var(--timer_victory_color)",document.getElementById("timer").style.textShadow="0 0 10px #61e82c"),e}function _e(){for(let e=0;e<u;e++){const t=e*.3;for(let o=0;o<u;o++){const r=document.getElementById(`cell_${e}_${o}`);r&&(r.classList.add("victory_row"),r.style.animationDelay=`${t}s`)}}}let p=null;document.addEventListener("DOMContentLoaded",async()=>{const e=localStorage.getItem("colors_matrix");if(e){p=JSON.parse(e);const t=p.length;Z(t,p),F(p,!1)}else await Y()});document.getElementById("new_game").addEventListener("click",Y);async function Y(){const e=parseInt(document.getElementById("size").value),t=document.getElementById("difficulty").value;p=await ie(e,t),p?(Z(e,p),F(p,!0),localStorage.setItem("colors_matrix",JSON.stringify(p))):alert("Couldn't get a new board")}function Z(e,t){const o=document.getElementById("board");o.innerHTML="";for(let r=0;r<e;r++){const n=document.createElement("tr");for(let l=0;l<e;l++){const i=document.createElement("td"),s=t[r][l];i.id=`cell_${r}_${l}`,i.className=`cell_color_${s}`,n.appendChild(i)}o.appendChild(n)}}let m={grid:null,visual_help:null,theme:null,difficulty:null,size:null};const d=document;function pe(){const e=localStorage.getItem("stored_selections");if(e)try{m=JSON.parse(e),d.getElementById("grid_selector").value=m.grid,d.getElementById("visual_settings").value=m.visual_help,d.getElementById("theme_selector").value=m.theme,d.getElementById("difficulty").value=m.difficulty,d.getElementById("size").value=m.size}catch(t){console.warn("Error parsing stored selections",t)}}function L(){m.grid=d.getElementById("grid_selector").value,m.visual_help=d.getElementById("visual_settings").value,m.theme=d.getElementById("theme_selector").value,m.difficulty=d.getElementById("difficulty").value,m.size=d.getElementById("size").value,localStorage.setItem("stored_selections",JSON.stringify(m))}window.addEventListener("DOMContentLoaded",pe);window.addEventListener("beforeunload",L);d.getElementById("grid_selector").addEventListener("change",L);d.getElementById("visual_settings").addEventListener("change",L);d.getElementById("theme_selector").addEventListener("change",L);d.getElementById("difficulty").addEventListener("change",L);d.getElementById("size").addEventListener("change",L);
