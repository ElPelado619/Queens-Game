(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const a of l.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(o){if(o.ep)return;o.ep=!0;const l=r(o);fetch(o.href,l)}})();const ue="0.5.0";function me(){const e=new Date().toLocaleString(),t=["color: #61dafb","background-color: #222","padding: 4px 8px","border-radius: 4px","font-family: monospace"].join(";");console.log(`%c♕ Queens Game v${ue} | ${e} ♕`,t)}typeof window<"u"&&(me(),performance?.mark&&performance.mark("game_init_start"));const fe="modulepreload",_e=function(e){return"https://elpelado619.github.io/Queens-Game/"+e},U={},v=function(t,r,n){let o=Promise.resolve();if(r&&r.length>0){let _=function(g){return Promise.all(g.map(B=>Promise.resolve(B).then(O=>({status:"fulfilled",value:O}),O=>({status:"rejected",reason:O}))))};var a=_;document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),c=i?.nonce||i?.getAttribute("nonce");o=_(r.map(g=>{if(g=_e(g),g in U)return;U[g]=!0;const B=g.endsWith(".css"),O=B?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${g}"]${O}`))return;const p=document.createElement("link");if(p.rel=B?"stylesheet":fe,B||(p.as="script"),p.crossOrigin="",p.href=g,c&&p.setAttribute("nonce",c),document.head.appendChild(p),B)return new Promise((ce,de)=>{p.addEventListener("load",ce),p.addEventListener("error",()=>de(new Error(`Unable to preload CSS for ${g}`)))})}))}function l(i){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=i,window.dispatchEvent(c),!c.defaultPrevented)throw i}return o.then(i=>{for(const c of i||[])c.status==="rejected"&&l(c.reason);return t().catch(l)})};let m={grid:null,visual_help:null,icons_border:null,theme:null,difficulty:null,size:null};const d=document;function ee(){const e=localStorage.getItem("stored_selections");if(e)try{m=JSON.parse(e),d.getElementById("grid_selector").value=m.grid,d.getElementById("visual_settings").value=m.visual_help,d.getElementById("icon_border_selector").value=m.icons_border,d.getElementById("theme_selector").value=m.theme,d.getElementById("difficulty").value=m.difficulty,d.getElementById("size").value=m.size}catch(t){console.warn("Error parsing stored selections",t)}}function L(){m.grid=d.getElementById("grid_selector").value,m.visual_help=d.getElementById("visual_settings").value,m.icons_border=d.getElementById("icon_border_selector").value,m.theme=d.getElementById("theme_selector").value,m.difficulty=d.getElementById("difficulty").value,m.size=d.getElementById("size").value,localStorage.setItem("stored_selections",JSON.stringify(m))}window.addEventListener("DOMContentLoaded",ee);window.addEventListener("beforeunload",L);d.getElementById("grid_selector").addEventListener("change",L);d.getElementById("visual_settings").addEventListener("change",L);d.getElementById("icon_border_selector").addEventListener("change",L);d.getElementById("theme_selector").addEventListener("change",L);d.getElementById("difficulty").addEventListener("change",L);d.getElementById("size").addEventListener("change",L);const te=Object.assign({"./boards/boards6.js":()=>v(()=>import("./boards6-C5N9PQ90.js"),[]),"./boards/boards7.js":()=>v(()=>import("./boards7-_AeYOdc4.js"),[]),"./boards/boards8.js":()=>v(()=>import("./boards8-eyEYXSly.js"),[]),"./boards/boards9.js":()=>v(()=>import("./boards9-C4Gx4bda.js"),[]),"./boards/chaosBoards10.js":()=>v(()=>import("./chaosBoards10-DuAJgUPw.js"),[]),"./boards/chaosBoards6.js":()=>v(()=>import("./chaosBoards6-HEwkA7iM.js"),[]),"./boards/chaosBoards7.js":()=>v(()=>import("./chaosBoards7-BlOR_rZY.js"),[]),"./boards/chaosBoards8.js":()=>v(()=>import("./chaosBoards8-QrK0K2FD.js"),[]),"./boards/chaosBoards9.js":()=>v(()=>import("./chaosBoards9-D_NqF0HB.js"),[])});async function F(e,t,r){let n=`./boards/boards${e}.js`;t==="chaos"&&(n=`./boards/chaosBoards${e}.js`);const o=te[n];if(!o)return console.error(`No board file found for path: ${n}`),null;const a=(await o())[`boards${e}`];if(!a)return console.error(`No boards object named boards${e} in ${n}`),null;if(!isNaN(r)&&r>=1){const _=`board_${r}`;return _ in a?(console.log(`Loaded ${_}, from boards${e} in ${n}`),{matrix_key:a[_],board_number:r}):(console.warn(`${_} does not exist in boards${e}.`),null)}const i=Object.keys(a);if(i.length===0)return console.error(`No boards found in boards${e}`),null;const c=i[Math.floor(Math.random()*i.length)];return{matrix_key:a[c],board_number:parseInt(c.split("_")[1])}}document.addEventListener("DOMContentLoaded",async()=>{board_count.innerHTML="Boards that match the settings: ",ee(),Q()});document.getElementById("size").addEventListener("change",Q);document.getElementById("difficulty").addEventListener("change",Q);async function Q(){const e=document.getElementById("size").value,t=document.getElementById("difficulty").value,r=document.getElementById("board_count");let n=`./boards/boards${e}.js`;t==="chaos"&&(n=`./boards/chaosBoards${e}.js`);const o=te[n];if(!o)return console.warn(`No board file found for path: ${n}`),r.innerHTML="Boards that match the settings: 0",null;const a=(await o())[`boards${e}`];if(!a)return console.warn(`No boards object named boards${e} in ${n}`),r.innerHTML="Boards that match the settings: 0",null;const i=Object.keys(a);let c=0;for(let _=0;_<i.length;_++)c++;r.innerHTML="Boards that match the settings: "+c}let b=0,A=null;const ne=document.getElementById("timer");function ge(e){clearInterval(A);const t=localStorage.getItem("gameCompleted")==="true",r=JSON.parse(localStorage.getItem("miliseconds"));r!==null&&typeof r=="number"&&(b=r),W(),!t&&(e&&(b=0,localStorage.setItem("miliseconds",JSON.stringify(b)),W()),A=setInterval(ye,10))}function ye(){b+=10,localStorage.setItem("miliseconds",JSON.stringify(b));const e=Math.floor(b/1e3),t=Math.floor(e/3600),r=Math.floor(e%3600/60),n=e%60,o=Math.floor(b%1e3/10),l=`${String(t).padStart(2,"0")}:${String(r).padStart(2,"0")}:${String(n).padStart(2,"0")}.${String(o).padStart(2,"0")}`;ne.textContent=l}function W(){const e=Math.floor(b/1e3),t=Math.floor(e/3600),r=Math.floor(e%3600/60),n=e%60,o=Math.floor(b%1e3/10),l=`${String(t).padStart(2,"0")}:${String(r).padStart(2,"0")}:${String(n).padStart(2,"0")}.${String(o).padStart(2,"0")}`;ne.textContent=l}function oe(){clearInterval(A),A=null}function be(){return b}const E={},X={place:.4,remove:.38,win:0},Y={place:1.2,remove:.45,win:1},Z={place:1,remove:1.85,win:1},T={place:.5,remove:.5,win:.4};let q=!1;const V="https://elpelado619.github.io/Queens-Game/audio/";function ve(){E.place=new Audio(V+"place.mp3"),E.remove=new Audio(V+"place.mp3"),E.win=new Audio(V+"win.mp3"),E.place.volume=T.place,E.remove.volume=T.remove,E.win.volume=T.win}function H(e){if(!q){if(!E[e]){console.warn(`Sound "${e}" not loaded`);return}try{const t=new Audio(E[e].src);t.currentTime=X[e],t.playbackRate=Y[e]*Z[e],t.volume=T[e],t.play().catch(r=>{console.warn("Audio play failed:",r);try{const n=new Audio(`/audio/${e==="remove"?"place":e}.mp3`);n.currentTime=X[e],n.playbackRate=Y[e]*Z[e],n.volume=T[e],n.play()}catch(n){console.warn("Fallback failed:",n)}})}catch(t){console.warn("Sound playback error:",t)}}}function pe(){const e=()=>{const t=new Audio;t.volume=0,t.play().then(()=>t.remove()),document.removeEventListener("click",e),document.removeEventListener("touchstart",e)};document.addEventListener("click",e,{once:!0}),document.addEventListener("touchstart",e,{once:!0})}ve();pe();document.getElementById("volume").addEventListener("click",()=>{const e=document.getElementById("volume");q?(e.classList.remove("volume_off"),e.classList.add("volume_on"),q=!1):(e.classList.remove("volume_on"),e.classList.add("volume_off"),q=!0)});let s=[],S=[],u=null,f=!1,N=!1,h=null,$=new Set,P=null,k=!0,z=!1,M=null,I="cross";document.getElementById("switch_marker").addEventListener("click",re);document.addEventListener("keydown",function(e){e.key===" "&&re()});document.addEventListener("DOMContentLoaded",()=>{I=localStorage.getItem("marker_type"),le()});function re(){I==="cross"?I="flag":I="cross",le()}function le(){const e=document.getElementById("switch_marker");e.innerHTML="";const t=document.createElement("div");I==="cross"?(t.className="switch_marker_image cross",e.appendChild(t)):(t.className="switch_marker_image flag",e.appendChild(t)),localStorage.setItem("marker_type",I)}window.addEventListener("blur",()=>{N=!1,h=null,$.clear()});document.addEventListener("mousedown",e=>{if(f||e.button!==0&&e.button!==2)return;N=!0,h=e.button,$.clear(),k=!0;const t=e.target.closest("td");if(t&&t.id){const r=t.id.split("_");if(r.length>=3){const n=Number(r[1]),o=Number(r[2]);if(h===2){z=!0;const l=s[n]?s[n][o]:void 0;M=l===3?"erase_flags":l===2?"erase_crosses":"draw"}x(n,o,h===0?1:2)}}});document.addEventListener("contextmenu",e=>{z&&e.preventDefault(),z=!1});document.addEventListener("mouseup",e=>{e.button===h&&(N=!1,h=null,M=null,P=setTimeout(()=>$.clear(),50))});document.getElementById("board").addEventListener("contextmenu",e=>e.preventDefault());document.getElementById("board_table").addEventListener("contextmenu",e=>e.preventDefault());function se(){N=!1,h=null,$.clear(),k=!0,P&&(clearTimeout(P),P=null)}async function ae(e,t){if(!e)return;document.getElementById("timer").style.color="var(--color_text)",document.getElementById("timer").style.textShadow="0 0 0px #00000000",S=e,u=S.length;let r=!0;const n=localStorage.getItem("queens_matrix");if(f=localStorage.getItem("gameCompleted")==="true",n&&!t)try{const l=JSON.parse(n);if(Array.isArray(l)&&l.length===u)s=l,r=!1;else throw new Error("Invalid size")}catch{C("all"),localStorage.setItem("queens_matrix",JSON.stringify(s))}else C("all"),localStorage.setItem("queens_matrix",JSON.stringify(s));R(),Ee(),f?oe():ge(r&&!f),j()}function R(){K=[];for(let e=0;e<u;e++)for(let t=0;t<u;t++)D(e,t)}function D(e,t){const r=document.getElementById(`cell_${e}_${t}`);if(!r)return;const n=s[e][t];if(r.innerHTML="",n===1){const o=document.createElement("div");o.className="board_icons icon_queen",o.dataset.row=e,o.dataset.col=t,r.appendChild(o)}else if(n===2){const o=document.createElement("div");o.className="board_icons icon_cross",r.appendChild(o)}else if(n===3){const o=document.createElement("div");o.className="board_icons icon_flag",r.appendChild(o)}}function x(e,t,r){if(f||!he(e,t))return;const n=`${e}_${t}`;if(!$.has(n)){if($.add(n),s[e][t],r===1){const o=s[e][t]===1;s[e][t]=o?0:1,k&&(s[e][t]===1?H("place"):o&&H("remove"))}else if(r===2){const o=I==="flag"?3:2;s[e][t]=s[e][t]===o?0:o}k=!1,D(e,t),localStorage.setItem("queens_matrix",JSON.stringify(s)),j()}}function Ee(){for(let e=0;e<u;e++)for(let t=0;t<u;t++){const r=document.getElementById(`cell_${e}_${t}`);if(!r)continue;const n=r.cloneNode(!0);r.replaceWith(n),n.addEventListener("mouseenter",()=>{if(N&&!f)if(h===2)if(M==="draw"){const o=I==="flag"?3:2;s[e][t]!==o&&x(e,t,2)}else(M==="erase_flags"&&s[e][t]===3||M==="erase_crosses"&&s[e][t]===2)&&(s[e][t]=0,D(e,t),localStorage.setItem("queens_matrix",JSON.stringify(s)));else x(e,t,1)}),n.addEventListener("click",o=>{o.button===0&&!f&&(k=!0,x(e,t,1))}),n.addEventListener("contextmenu",o=>{o.preventDefault(),f||(k=!0,x(e,t,2))})}}function C(e){if(se(),e==="crosses"){for(let t=0;t<u;t++)for(let r=0;r<u;r++)if(s[t][r]===2){s[t][r]=0;const n=document.getElementById(`cell_${t}_${r}`);n&&(n.innerHTML="")}}else if(e==="flags"){for(let t=0;t<u;t++)for(let r=0;r<u;r++)if(s[t][r]===3){s[t][r]=0;const n=document.getElementById(`cell_${t}_${r}`);n&&(n.innerHTML="")}}else{f=!1,localStorage.setItem("gameCompleted","false"),s=[];for(let t=0;t<u;t++){s[t]=[];for(let r=0;r<u;r++){s[t][r]=0;const n=document.getElementById(`cell_${t}_${r}`);n&&(n.innerHTML="")}}}}function he(e,t){return e>=0&&e<u&&t>=0&&t<u}document.getElementById("clear_board").addEventListener("click",()=>{f||(C("all"),localStorage.setItem("queens_matrix",JSON.stringify(s)),R(),j())});document.getElementById("clear_crosses").addEventListener("click",()=>{f||(C("crosses"),localStorage.setItem("queens_matrix",JSON.stringify(s)),R(),j())});document.getElementById("clear_flags").addEventListener("click",()=>{f||(C("flags"),localStorage.setItem("queens_matrix",JSON.stringify(s)),R(),j())});let K=[];function j(){if(f||!S)return!1;K=[];let e=!0;const t=[],r={},n=S&&S.flat?new Set(S.flat()):new Set;for(let o=0;o<u;o++)for(let l=0;l<u;l++){const a=document.getElementById(`cell_${o}_${l}`);if(a){const i=a.querySelector(".icon_queen");i&&i.classList.remove("invalid_queen")}if(s[o][l]===1){const i=S[o][l];t.push({row:o,col:l,color:i}),r[i]=(r[i]||0)+1}}for(let o=0;o<t.length;o++){let l=!1;for(let a=0;a<t.length;a++){if(o===a)continue;const i=t[o],c=t[a];(i.row===c.row||i.col===c.col||i.color===c.color||Math.abs(i.row-c.row)===1&&Math.abs(i.col-c.col)===1)&&(l=!0)}if(l){K.push([t[o].row,t[o].col]);const a=document.querySelector(`#cell_${t[o].row}_${t[o].col} .icon_queen`);a&&a.classList.add("invalid_queen"),e=!1}}for(const o of n)if(r[o]!==1){e=!1;break}return e&&t.length>0&&(f=!0,localStorage.setItem("gameCompleted","true"),localStorage.setItem("miliseconds",JSON.stringify(be())),se(),oe(),H("win"),Ie(),document.getElementById("timer").style.color="var(--timer_victory_color)",document.getElementById("timer").style.textShadow="0 0 10px #61e82c"),e}function Ie(){for(let e=0;e<u;e++){const t=e*.3;for(let r=0;r<u;r++){const n=document.getElementById(`cell_${e}_${r}`);n&&(n.classList.add("victory_row"),n.style.animationDelay=`${t}s`)}}}let y=null,w=null;document.addEventListener("DOMContentLoaded",async()=>{const e=localStorage.getItem("colors_matrix");if(w=localStorage.getItem("current_board_number"),document.getElementById("board_number").value=parseInt(w),e){y=JSON.parse(e);const t=y.length;ie(t,y),ae(y,!1)}else w?await J("by_number"):await J("random");G(),w&&(document.getElementById("board_id_text").innerHTML=`Board ID: ${w}`)});document.getElementById("new_game").addEventListener("click",()=>J("random"));document.getElementById("load_by_number").addEventListener("click",()=>J("by_number"));document.getElementById("board_number").addEventListener("change",()=>{G()});window.addEventListener("beforeunload",()=>{localStorage.setItem("current_board_number",w)});function G(){const e=parseInt(document.getElementById("board_number").value),t=document.getElementById("load_by_number");!e||e<1?(t.disabled=!0,t.classList.add("disabled")):(t.disabled=!1,t.classList.remove("disabled"))}async function J(e){const t=parseInt(document.getElementById("size").value),r=document.getElementById("difficulty").value;let n;if(e==="by_number"){const o=parseInt(document.getElementById("board_number").value);n=await F(t,r,o),n&&n.matrix_key&&(y=n.matrix_key)}else n=await F(t,r,null),n&&n.matrix_key&&(y=n.matrix_key);y&&n?(ie(t,y),ae(y,!0),localStorage.setItem("colors_matrix",JSON.stringify(y)),document.getElementById("board_number").value=parseInt(n.board_number),document.getElementById("board_id_text").innerHTML=`Board ID: ${n.board_number}`,w=n.board_number):alert("Couldn't get a new board with the chosen settings."),n&&n.board_number&&localStorage.setItem("current_board_number",n.board_number),G()}function ie(e,t){const r=document.getElementById("board");r.innerHTML="";for(let n=0;n<e;n++){const o=document.createElement("tr");for(let l=0;l<e;l++){const a=document.createElement("td"),i=t[n][l];a.id=`cell_${n}_${l}`,a.className=`cell_color_${i}`,o.appendChild(a)}r.appendChild(o)}}
